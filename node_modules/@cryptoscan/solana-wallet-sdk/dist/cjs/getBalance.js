"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getBalance = void 0;
const web3_js_1 = require("@solana/web3.js");
const spl_token_1 = require("@solana/spl-token");
const bignumber_js_1 = require("bignumber.js");
const COIN_LAMPORTS = 10 ** 6;
const SOL_LAMPORTS = 10 ** 9;
const getBalance = async (walletAddress, coinAddress, connection = new web3_js_1.Connection('https://api.mainnet-beta.solana.com/'), commitment) => {
    try {
        const walletKey = new web3_js_1.PublicKey(walletAddress);
        if (!coinAddress) {
            const lamports = await connection.getBalance(walletKey, commitment || 'processed');
            return lamports / SOL_LAMPORTS;
        }
        const walletAssociatedAccountKey = await (0, spl_token_1.getAssociatedTokenAddress)(new web3_js_1.PublicKey(coinAddress), walletKey);
        const balance = await connection.getTokenAccountBalance(walletAssociatedAccountKey, commitment || 'processed');
        return (0, bignumber_js_1.BigNumber)(balance.value.amount).div(COIN_LAMPORTS).toNumber();
    }
    catch (e) {
        console.log(e.message);
        return 0;
    }
};
exports.getBalance = getBalance;
